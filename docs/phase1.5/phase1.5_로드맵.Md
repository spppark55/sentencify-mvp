ì‚¬ìš©ìë‹˜ì˜ \*\*"ë‹¨ë… í…ŒìŠ¤íŠ¸ í™˜ê²½ ì œê³µ"\*\*ê³¼ \*\*"ë¬¸ì„œí™”(docs ì—…ë°ì´íŠ¸) ì˜ë¬´í™”"\*\*ë¼ëŠ” ë‘ ê°€ì§€ ëŒ€ì›ì¹™ì„ ì™„ë²½í•˜ê²Œ ìˆ™ì§€í–ˆìŠµë‹ˆë‹¤. ì´ ì›ì¹™ì€ ì‹œìŠ¤í…œì˜ ì•ˆì •ì„±ì„ ë³´ì¥í•˜ê³ , ê°œë°œ ì§„í–‰ ìƒí™©ì„ íˆ¬ëª…í•˜ê²Œ ê´€ë¦¬í•˜ëŠ” ë° í•„ìˆ˜ì ì…ë‹ˆë‹¤.

ì´ ì›ì¹™ì„ ë°˜ì˜í•˜ì—¬ **Phase 1.5 ë¡œë“œë§µ**ì„ ë‹¤ì‹œ ì •êµí•˜ê²Œ ìˆ˜ë¦½í–ˆìŠµë‹ˆë‹¤.

-----

# ğŸ—“ï¸ Phase 1.5: Macro Context Hybrid ìƒì„¸ ë¡œë“œë§µ (TDD & Doc-Driven)

ê° ë‹¨ê³„ëŠ” **êµ¬í˜„ â†’ ë‹¨ë… í…ŒìŠ¤íŠ¸(ìŠ¤í¬ë¦½íŠ¸) â†’ í†µí•© â†’ ë¬¸ì„œ ì—…ë°ì´íŠ¸** ìˆœìœ¼ë¡œ ì§„í–‰ë©ë‹ˆë‹¤.

### **Step 1. Redis ì¸í”„ë¼ & Schema F (Macro Cache)**

  * **ëª©í‘œ:** Redis ì—°ê²° ëª¨ë“ˆ êµ¬ì¶• ë° Macro Context ë°ì´í„° êµ¬ì¡° ì •ì˜.
  * **êµ¬í˜„:** `api/app/redis/client.py`, `api/app/models/macro.py` (Schema F).
  * **ë‹¨ë… í…ŒìŠ¤íŠ¸:** `scripts/test_step1_redis.py` (Redis ì ‘ì†, Set/Get, TTL ë™ì‘, Pydantic ê²€ì¦ í…ŒìŠ¤íŠ¸).
  * **ë¬¸ì„œí™”:** `docs/curr_progress.md` (Redis ì—°ë™ ì™„ë£Œ), `docs/phase1.5_test_lists.md` (ìºì‹œ ë™ì‘ í…ŒìŠ¤íŠ¸ í•­ëª©).

### **Step 2. Diff Calculation & Schema K (Gatekeeper)**

  * **ëª©í‘œ:** ë¬¸ì„œ ë³€ê²½ ê°ì§€ ì•Œê³ ë¦¬ì¦˜ ë° ì›ë³¸ ì €ì¥ì†Œ ëª¨ë¸ë§.
  * **êµ¬í˜„:** `api/app/utils/diff.py` (Levenshtein ë¹„ìœ¨ ê³„ì‚°), `api/app/mongo/document_store.py` (Schema K).
  * **ë‹¨ë… í…ŒìŠ¤íŠ¸:** `scripts/test_step2_diff.py` (í…ìŠ¤íŠ¸ A vs B ì…ë ¥ ì‹œ diff\_ratio ì •í™•ë„ ê²€ì¦, Mongo ì €ì¥ í™•ì¸).
  * **ë¬¸ì„œí™”:** `docs/curr_progress.md` (Diff ë¡œì§ êµ¬í˜„), `docs/phase1.5_test_lists.md` (Diff ì„ê³„ê°’ í…ŒìŠ¤íŠ¸ í•­ëª©).

### **Step 3. Macro ETL Service (LLM Analysis)**

  * **ëª©í‘œ:** í…ìŠ¤íŠ¸ ì…ë ¥ ì‹œ LLMì„ í˜¸ì¶œí•˜ì—¬ ì¹´í…Œê³ ë¦¬ë¥¼ ë¶„ì„í•˜ê³  Redisì— ì €ì¥í•˜ëŠ” ì„œë¹„ìŠ¤.
  * **êµ¬í˜„:** `api/app/services/macro_service.py` (Gemini í˜¸ì¶œ ë° Redis ì €ì¥).
  * **ë‹¨ë… í…ŒìŠ¤íŠ¸:** `scripts/test_step3_macro_llm.py` (ìƒ˜í”Œ í…ìŠ¤íŠ¸ ì£¼ì… â†’ LLM ì‘ë‹µ íŒŒì‹± â†’ Redis ì €ì¥ ì—¬ë¶€ í™•ì¸).
  * **ë¬¸ì„œí™”:** `docs/curr_progress.md` (Macro ETL êµ¬í˜„), `docs/phase1.5_test_lists.md` (LLM ë¶„ì„ ì •í™•ë„ í…ŒìŠ¤íŠ¸ í•­ëª©).

### **Step 4. Adaptive Scoring API Integration**

  * **ëª©í‘œ:** `/recommend` APIì—ì„œ Redisë¥¼ ì¡°íšŒí•˜ê³  ë¬¸ì„œ ê¸¸ì´ì— ë”°ë¼ ê°€ì¤‘ì¹˜($\alpha$) ì ìš©.
  * **êµ¬í˜„:** `api/app/main.py` ìˆ˜ì • (Adaptive Logic ì¶”ê°€), `recommend_log` ìŠ¤í‚¤ë§ˆ ì—…ë°ì´íŠ¸.
  * **ë‹¨ë… í…ŒìŠ¤íŠ¸:** `scripts/test_step4_scoring.py` (Mock ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¬¸ì„œ ê¸¸ì´ì— ë”°ë¥¸ P\_final ì ìˆ˜ ë³€í™” ê²€ì¦).
  * **ë¬¸ì„œí™”:** `docs/curr_progress.md` (Phase 1.5 í†µí•© ì™„ë£Œ), `docs/phase1.5_test_lists.md` (ì‹œë‚˜ë¦¬ì˜¤ A/B/C í†µí•© í…ŒìŠ¤íŠ¸).

-----
